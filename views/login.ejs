<h2>Login</h2>

<p style="background:#fee2e2;color:#b91c1c;padding:0.75rem 1rem;border-radius:6px;text-align:center;font-weight:600;margin-bottom:1rem;">
  <%= message || '' %>
</p>

<form id="login-form" action="/login" method="POST" style="display:flex; flex-direction: column; gap: 1rem; max-width: 400px; margin: auto;">
  <input name="identifier" placeholder="Email or Username" required autocomplete="username"
    style="padding:0.75rem 1rem; border:1.5px solid #ccc; border-radius:6px; font-size:1rem; width:100%;" />
  <input name="password" type="password" placeholder="Password" required autocomplete="current-password"
    style="padding:0.75rem 1rem; border:1.5px solid #ccc; border-radius:6px; font-size:1rem; width:100%;" />
  <input type="hidden" name="token" id="g-recaptcha-token" />
  <button type="submit" 
    style="padding:0.75rem 1rem; background:#2563eb; border:none; border-radius:6px; color:#fff; font-weight:600; cursor:pointer; font-size:1rem;">
    Login
  </button>
</form>

<div style="text-align:center; margin-top:1rem;">
  <a href="/register" style="color:#2563eb; text-decoration:none; font-weight:600;">Register</a>
</div>

<script src="https://www.google.com/recaptcha/api.js?render=6LeQvUErAAAAAIhq1_vSbv7FA8DfpZ95JbFAoCIM"></script>
<script>
  const form = document.getElementById('login-form');
  form.addEventListener('submit', function (e) {
    e.preventDefault();

    grecaptcha.ready(function () {
      grecaptcha.execute('6LeQvUErAAAAAIhq1_vSbv7FA8DfpZ95JbFAoCIM', { action: 'login' }).then(function (token) {
        document.getElementById('g-recaptcha-token').value = token;
        form.submit();
      });
    });
  });
</script>
